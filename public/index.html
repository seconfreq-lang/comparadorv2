<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comparador de Pre√ßos NFe</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üîç Comparador de Pre√ßos NFe</h1>
            <p>Compare pre√ßos entre XML da NFe e planilha Excel</p>
        </header>

        <section class="upload-section">
            <div class="upload-group">
                <div class="upload-container">
                    <label class="upload-label">
                        <input type="file" id="xmlFile" accept=".xml" multiple hidden>
                        <div class="upload-area">
                            <div class="upload-icon">üìÑ</div>
                            <span>Upload XMLs (.xml) - M√∫ltiplos Arquivos</span>
                            <div class="file-name" id="xmlFileName"></div>
                        </div>
                    </label>
                    <button id="clearXmlBtn" class="btn-clear" title="Limpar arquivos XML">üóëÔ∏è</button>
                </div>

                <div class="upload-container">
                    <label class="upload-label">
                        <input type="file" id="xlsxFile" accept=".xlsx,.xls" hidden>
                        <div class="upload-area">
                            <div class="upload-icon">üìä</div>
                            <span>Upload Excel (.xlsx)</span>
                            <div class="file-name" id="xlsxFileName"></div>
                        </div>
                    </label>
                    <button id="clearXlsxBtn" class="btn-clear" title="Limpar arquivo Excel">üóëÔ∏è</button>
                </div>
            </div>

            <div class="margin-config">
                <label for="marginPercent" class="margin-label">
                    üìä Margem para Compara√ß√£o (%):
                </label>
                <input type="number" id="marginPercent" class="margin-input" 
                       value="50" min="0" max="1000" step="0.1" 
                       placeholder="Ex: 50 para 1.5x">
                <span class="margin-help">Exemplo: 50% = 1.5x o unit√°rio real</span>
            </div>

            <div class="button-group">
                <button id="compareBtn" class="btn btn-primary" disabled>
                    üîÑ Comparar
                </button>
                <button id="exportBtn" class="btn btn-secondary" disabled>
                    üì• Exportar CSV
                </button>
                <button id="detailsBtn" class="btn btn-info" disabled>
                    üîç Detalhes C√°lculo
                </button>
            </div>
        </section>

        <section class="controls-section">
            <div class="filters">
                <h3>Filtros por Status</h3>
                <div class="filter-group">
                    <button class="filter-btn active" data-filter="ALL">Todos</button>
                    <button class="filter-btn status-ok" data-filter="OK">OK</button>
                    <button class="filter-btn status-abaixo" data-filter="ABAIXO_MINIMO">Abaixo M√≠nimo</button>
                    <button class="filter-btn status-sem" data-filter="SEM_PRECO">Sem Pre√ßo</button>
                    <button class="filter-btn status-erro" data-filter="ERRO_PARSING">Erro Parsing</button>
                </div>
            </div>

            <div class="filters">
                <h3>Filtros por Match Type</h3>
                <div class="filter-group">
                    <button class="filter-btn-match active" data-filter="ALL">Todos</button>
                    <button class="filter-btn-match" data-filter="EAN-Com">EAN-Com</button>
                    <button class="filter-btn-match" data-filter="EAN-Trib">EAN-Trib</button>
                    <button class="filter-btn-match" data-filter="CODIGO">C√≥digo</button>
                    <button class="filter-btn-match" data-filter="FUZZY">Fuzzy</button>
                    <button class="filter-btn-match" data-filter="NULL">NULL</button>
                </div>
            </div>

            <div class="search-section">
                <input type="text" id="searchInput" placeholder="üîç Buscar por c√≥digo ou descri√ß√£o..." />
            </div>
        </section>

        <section class="conference-section">
            <div class="conference-panel">
                <h3>üìä Painel de Confer√™ncia</h3>
                <div class="conference-info">
                    <div class="conference-item">
                        <span class="conference-label">Œ£ Total Itens:</span>
                        <span class="conference-value" id="somaItens">R$ 0,00</span>
                    </div>
                    <div class="conference-item">
                        <span class="conference-label">vNF (XML):</span>
                        <span class="conference-value" id="vNF">R$ 0,00</span>
                    </div>
                    <div class="conference-item">
                        <span class="conference-label">Diferen√ßa:</span>
                        <span class="conference-value" id="diferenca">R$ 0,00</span>
                        <span class="conference-status" id="statusConferencia"></span>
                    </div>
                </div>
            </div>
        </section>

        <section class="stats-section">
            <div class="stats-group">
                <h3>üìä Contadores por Status</h3>
                <div class="stats-cards">
                    <div class="stat-card status-ok">
                        <div class="stat-number" id="countOK">0</div>
                        <div class="stat-label">OK</div>
                    </div>
                    <div class="stat-card status-abaixo">
                        <div class="stat-number" id="countABAIXO_MINIMO">0</div>
                        <div class="stat-label">Abaixo M√≠nimo</div>
                    </div>
                    <div class="stat-card status-sem">
                        <div class="stat-number" id="countSEM_PRECO">0</div>
                        <div class="stat-label">Sem Pre√ßo</div>
                    </div>
                    <div class="stat-card status-erro">
                        <div class="stat-number" id="countERRO_PARSING">0</div>
                        <div class="stat-label">Erro Parsing</div>
                    </div>
                </div>
            </div>

            <div class="stats-group">
                <h3>üéØ Contadores por Match Type</h3>
                <div class="stats-cards">
                    <div class="stat-card">
                        <div class="stat-number" id="countEAN-Com">0</div>
                        <div class="stat-label">EAN-Com</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="countEAN-Trib">0</div>
                        <div class="stat-label">EAN-Trib</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="countCODIGO">0</div>
                        <div class="stat-label">C√≥digo</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="countFUZZY">0</div>
                        <div class="stat-label">Fuzzy</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="countNULL">0</div>
                        <div class="stat-label">NULL</div>
                    </div>
                </div>
            </div>
        </section>

        <section class="results-section">
            <div class="table-container">
                <table id="resultsTable">
                    <thead>
                        <tr>
                            <th>C√≥digo</th>
                            <th>EAN XML</th>
                            <th>EAN XML (Trib)</th>
                            <th>EAN Excel</th>
                            <th>Descri√ß√£o</th>
                            <th>Qtd XML</th>
                            <th>Unid</th>
                            <th>Pre√ßo Bruto</th>
                            <th>Desc.</th>
                            <th>IPI</th>
                            <th>ST (cobrada)</th>
                            <th>Outros</th>
                            <th>Total Item</th>
                            <th>Unidades</th>
                            <th>Unit√°rio (real)</th>
                            <th>R$/L ou R$/KG</th>
                            <th>Pre√ßo Tabela</th>
                            <th>M√≠nimo (<span id="marginDisplay">1.5</span>√ó)</th>
                            <th>Status</th>
                            <th>Match Type</th>
                            <th>Observa√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="resultsBody">
                    </tbody>
                </table>
            </div>
        </section>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Processando arquivos...</p>
        </div>

        <div class="error-message" id="errorMessage"></div>
    </div>

    <script src="script.js"></script>
</body>
</html>